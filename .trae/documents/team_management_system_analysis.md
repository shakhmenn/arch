# Анализ системы управления командами TaskFlow Club

## 1. Текущее состояние системы

### 1.1 Роли пользователей

В системе определены две основные роли:

- **ORGANIZER** - организатор с расширенными правами
- **ENTREPRENEUR** - предприниматель с ограниченными правами

### 1.2 Текущая архитектура команд

**База данных:**
- `Team` - команды с названием и описанием
- `UserTeam` - связь многие-ко-многим между пользователями и командами
- Ограничение: один пользователь может состоять только в одной команде

**Права доступа:**
- **ORGANIZER**: может создавать команды, видеть все команды, назначать пользователей в команды
- **ENTREPRENEUR**: видит только свою команду, не может создавать команды или управлять участниками

**API функционал:**
- `POST /teams` - создание команды (только ORGANIZER)
- `GET /teams` - список команд (ORGANIZER видит все, ENTREPRENEUR - только свою)
- `GET /teams/:id` - детали команды с участниками и задачами
- `POST /teams/:id/users` - назначение пользователя в команду (только ORGANIZER)

### 1.3 Проблемы текущей системы

1. **Масштабируемость**: система не рассчитана на текущие 70 участников клуба (с возможностью роста)
2. **Организация по десяткам**: отсутствует структура для группировки участников
3. **Иерархия управления**: нет промежуточных ролей между ORGANIZER и ENTREPRENEUR
4. **Ограничения команд**: пользователь может быть только в одной команде
5. **Коммуникация**: отсутствуют базовые инструменты для взаимодействия с участниками

## 2. Концепция организации по десяткам

### 2.1 Структура бизнес-клуба

```
Бизнес-клуб (текущие 70 участников, с возможностью роста)
├── Десяток 1 (10 участников)
│   ├── Лидер десятка (TEAM_LEADER)
│   └── Участники (ENTREPRENEUR)
├── Десяток 2 (10 участников)
│   ├── Лидер десятка (TEAM_LEADER)
│   └── Участники (ENTREPRENEUR)
├── ... (текущие 7 десятков, возможно расширение)
└── Организаторы (ORGANIZER)
```

### 2.2 Новые роли

**Предлагаемая система ролей:**

1. **SUPER_ORGANIZER** - главный администратор клуба
   - Управляет всеми десятками
   - Назначает лидеров десятков
   - Видит статистику по всему клубу

2. **ORGANIZER** - организатор/модератор
   - Помогает в управлении клубом
   - Может создавать десятки
   - Доступ к аналитике

3. **TEAM_LEADER** - лидер десятка
   - Управляет своим десятком (10 человек)
   - Назначает задачи участникам
   - Отслеживает метрики десятка
   - Проводит встречи и мероприятия
   - Осуществляет коммуникацию с участниками своего десятка

4. **ENTREPRENEUR** - участник десятка
   - Состоит в одном десятке
   - Выполняет задачи
   - Ведет свои метрики
   - Участвует в активностях десятка

### 2.3 Структура данных

**Новая модель Team (Десяток):**
```sql
model Team {
  id          Int      @id @default(autoincrement())
  name        String   // "Десяток №1", "Стартаперы", "IT-предприниматели"
  description String?
  maxMembers  Int      @default(10)  // Максимум участников
  leaderId    Int?     @map("leader_id")  // Лидер десятка
  leader      User?    @relation("TeamLeader", fields: [leaderId], references: [id])
  regionId    Int?     @map("region_id")  // Географический регион
  region      Region?  @relation(fields: [regionId], references: [id])
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now()) @map("created_at")
  
  // Relations
  members     UserTeam[]
  tasks       Task[]
  meetings    Meeting[]
  metrics     TeamMetrics[]
}
```

**Модель Region (Регион):**
```sql
model Region {
  id        Int      @id @default(autoincrement())
  name      String   // "Москва", "СПб", "Онлайн"
  code      String   @unique // "MSK", "SPB", "ONLINE"
  isActive  Boolean  @default(true)
  
  // Relations
  teams     Team[]
  users     User[]
}
```

**Обновленная модель User:**
```sql
model User {
  // ... существующие поля
  role            Role      @default(ENTREPRENEUR)
  regionId        Int?      @map("region_id")
  region          Region?   @relation(fields: [regionId], references: [id])
  
  // Relations
  teams           UserTeam[]
  ledTeams        Team[]    @relation("TeamLeader")  // Команды, которыми руководит
  // ... остальные связи
}
```

## 3. Функциональные требования

### 3.1 Управление десятками

**Для SUPER_ORGANIZER/ORGANIZER:**
- Создание новых десятков
- Назначение лидеров десятков
- Перемещение участников между десятками
- Просмотр статистики по всем десяткам
- Управление регионами

**Для TEAM_LEADER:**
- Просмотр участников своего десятка
- Создание задач для участников
- Планирование встреч десятка
- Отслеживание метрик десятка
- Коммуникация с участниками:
  * Отправка объявлений через доску объявлений
  * Планирование и проведение встреч
  * Обратная связь по выполнению задач
  * Мотивация и поддержка участников
  * Координация совместных проектов

**Для ENTREPRENEUR:**
- Просмотр информации о своем десятке
- Участие в активностях десятка
- Выполнение назначенных задач
- Ведение личных метрик

### 3.2 Новые API endpoints

```typescript
// Управление десятками
POST   /teams                    // Создание десятка (ORGANIZER+)
GET    /teams                    // Список десятков (с фильтрами)
GET    /teams/:id                // Детали десятка
PATCH  /teams/:id                // Обновление десятка
DELETE /teams/:id                // Деактивация десятка

// Управление участниками
POST   /teams/:id/members        // Добавление участника
DELETE /teams/:id/members/:userId // Удаление участника
PATCH  /teams/:id/leader         // Назначение лидера

// Региональное управление
GET    /regions                  // Список регионов
POST   /regions                  // Создание региона (SUPER_ORGANIZER)
GET    /regions/:id/teams        // Десятки региона

// Аналитика
GET    /analytics/teams          // Статистика по десяткам
GET    /analytics/regions        // Статистика по регионам
GET    /teams/:id/metrics        // Метрики десятка
```

### 3.3 Интерфейс пользователя

**Дашборд для ORGANIZER:**
- Карта десятков с количеством участников
- Статистика активности по десяткам
- Инструменты для создания и управления десятками
- Назначение лидеров

**Дашборд для TEAM_LEADER:**
- Список участников десятка с контактами
- Календарь встреч и мероприятий
- Задачи для участников
- Метрики и прогресс десятка
- Инструменты коммуникации:
  * Планировщик встреч
  * Доска объявлений
  * Инструменты обратной связи

**Дашборд для ENTREPRENEUR:**
- Информация о своем десятке
- Контакты участников десятка
- Календарь мероприятий
- Личные задачи и метрики
- Участие в обсуждениях

## 4. План реализации (адаптирован под 70 участников)

### Этап 1: Расширение системы ролей (1 неделя)
1. Добавление новых ролей в enum
2. Обновление модели Team (упрощенная версия без регионов)
3. Миграции базы данных
4. Обновление системы авторизации

### Этап 2: API для управления десятками (1-2 недели)
1. Расширенные сервисы для команд (десятков)
2. API для назначения лидеров
3. API для перемещения участников
4. Базовая система уведомлений

### Этап 3: Интерфейс управления (2-3 недели)
1. Дашборд для организаторов (упрощенный)
2. Интерфейс лидера десятка
3. Обновленный интерфейс участника
4. Базовые инструменты коммуникации

### Этап 4: Коммуникационные инструменты (1 неделя)
1. Планировщик встреч
2. Доска объявлений
3. Базовые инструменты обратной связи

### Этап 5: Аналитика и дополнительные функции (1-2 недели)
1. Базовые метрики десятков
2. Отчеты по активности
3. Система обратной связи
4. Оптимизация производительности

**Общее время реализации: 5-8 недель** (оптимизировано под текущий масштаб)

## 5. Технические соображения

### 5.1 Масштабируемость
- Индексы для быстрого поиска по командам (десяткам)
- Простое кэширование основных данных
- Базовая пагинация (для 70 участников не критично)
- Оптимизация основных запросов

### 5.2 Безопасность
- Строгая проверка прав доступа на уровне API
- Аудит действий организаторов
- Защита от несанкционированного доступа к данным других десятков
- Логирование всех операций управления

### 5.3 Производительность
- Простая загрузка данных участников (70 человек)
- Базовая оптимизация запросов к метрикам
- Простая система уведомлений
- Стандартная обработка статических ресурсов

### 3.4 Коммуникация с участниками - детальное описание

**Что означает коммуникация с участниками в контексте системы:**

1. **Информирование**:
   - Рассылка новостей и обновлений клуба
   - Уведомления о предстоящих мероприятиях
   - Объявления о новых возможностях и проектах

2. **Координация деятельности**:
   - Планирование и организация встреч десятка
   - Распределение ролей в совместных проектах
   - Синхронизация рабочих процессов

3. **Обратная связь**:
   - Получение отчетов о выполнении задач
   - Обсуждение результатов и метрик
   - Сбор предложений по улучшению работы

4. **Поддержка и мотивация**:
   - Индивидуальные консультации участников
   - Помощь в решении бизнес-задач
   - Признание достижений и успехов

5. **Сетевое взаимодействие**:
   - Знакомство участников друг с другом
   - Организация нетворкинга внутри десятка
   - Содействие в поиске партнеров и клиентов

**Инструменты коммуникации в системе (первый этап):**
- Календарь с возможностью планирования встреч
- Доска объявлений для важной информации
- Система опросов и голосований
- Базовые инструменты обратной связи

**Отложенные функции (будущие этапы):**
- Встроенный мессенджер для групповых и личных чатов
- Система push-уведомлений
- Форум для обсуждения идей и проектов

## 6. Заключение

Предлагаемая система позволит эффективно организовать текущих 70 участников бизнес-клуба по десяткам с четкой иерархией управления и возможностью масштабирования. Ключевые преимущества:

1. **Гибкий масштаб**: система рассчитана на текущие 70 участников с возможностью роста
2. **Структурированность**: четкая организация по 7+ десяткам
3. **Делегирование**: лидеры десятков снимают нагрузку с организаторов
4. **Базовая коммуникация**: основные инструменты для взаимодействия с участниками
5. **Аналитика**: детальная статистика по всем уровням
6. **Поэтапное развитие**: возможность добавления расширенных функций коммуникации

Система сохраняет обратную совместимость с текущей реализацией и позволяет постепенную миграцию существующих команд в новую структуру.